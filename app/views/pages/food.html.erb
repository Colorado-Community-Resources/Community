<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explore</title>

    <%= stylesheet_link_tag 'card', media: 'all' %>
    <%= javascript_include_tag "favorites" %> <!-- Include the JavaScript for AJAX submission -->
</head>
<body>
    <div class="full_container">
        <header>
            <div class="header-container">
                <h1>Explore Resources</h1>
            </div>
        </header>

        <div class="card-grid">
            <% @organizations.each do |organization| %> <!-- Loop through each organization -->
            <div class="card">
                <h2><%= organization.org_name %></h2> 
                <div class="description">
                    <p><%= organization.servicesSummary %></p> 
                    <p><%= organization.street %>, <%= organization.city %>, <%= organization.org_state %> <%= organization.zipcode %></p> 
                </div>

                <div class="contact-header">
                    <div class="contact-info">
                        Phone: <%= organization.phoneNumber %> 
                    </div>

                    <!-- Favorite button with AJAX form submission -->
                    <div class="favorite">
                        <%= form_with model: Favorite.new, url: favorites_path, method: :post, local: false do |f| %>
                            <%= f.hidden_field :organizationID_id, value: organization.organizationId %> <!-- Ensure the field is correctly named -->
                            <%= f.submit "Add to Favorites" %>
                        <% end %>
                    </div>
                </div>

                <div class="info-buttons">
                    <button class="add-button"><%= organization.street %></button> <!-- Address -->
                    <button class="phone-button"><%= organization.phoneNumber %></button> <!-- Phone Number -->
                    <button class="web-button"><a href="<%= organization.webLink %>">Website</a></button> <!-- Website -->
                </div>
            </div>
            <% end %>
        </div>
    </div>

    <!-- Include JavaScript for AJAX handling -->
    <%= javascript_include_tag 'favorites' %>
</body>
</html>
